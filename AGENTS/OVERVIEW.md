# SoccerHUD - 프로젝트 개요

## 🎯 프로젝트 목표

실시간 축구 중계 영상에서 공을 소유한 선수를 자동으로 인식하고, 피파 게임처럼 선수 머리 위에 이름/번호를 오버레이로 표시하는 크롬 익스텐션 개발.

## 🏗️ 전체 아키텍처

```
┌──────────────────────────────────────┐
│   Chrome Extension                    │
│   (Content Script)                    │
│                                       │
│   - 비디오 프레임 캡처 (30fps)        │
│   - WebSocket으로 서버 통신           │
│   - SVG 오버레이 렌더링               │
└─────────────┬────────────────────────┘
              │ ws://localhost:8765
              ↓
┌──────────────────────────────────────┐
│   Electron App (Companion)            │
│   (내장 Python 서버)                  │
│                                       │
│   - FastAPI + WebSocket               │
│   - YOLO 모델 실행 (CoreML/Metal)     │
│   - 선수 식별 로직                    │
│   - 결과 JSON 반환                    │
└──────────────────────────────────────┘
```

## 🔧 기술 스택

### 백엔드 (Python)
- **FastAPI**: WebSocket 서버
- **YOLOv8**: 객체 탐지 (공, 선수)
- **CoreML**: M4 Metal GPU 가속
- **OpenCV**: 비디오 전처리, Optical Flow
- **NumPy**: 수치 연산

### 프론트엔드 (Chrome Extension)
- **Manifest V3**: 크롬 익스텐션 API
- **Vanilla JavaScript**: 가볍게 유지
- **WebSocket API**: 실시간 통신
- **Canvas/SVG**: 오버레이 렌더링

### 패키징 & 배포
- **Electron**: Python 서버 번들링
- **PyInstaller**: Python 실행파일 변환
- **Chrome Web Store**: 익스텐션 배포

## 🎨 핵심 기능

### 1. 객체 탐지
- **공 탐지**: YOLOv8로 실시간 축구공 위치 추적
- **선수 탐지**: 각 선수의 바운딩 박스 생성
- **공 소유 판단**: 공과 가장 가까운 선수 계산 (거리 기반)

### 2. 선수 식별 (멀티모달 접근)
```
점수 = 유니폼 색상(40%) + 등번호 OCR(30%) + 필드 위치(20%) + 추적 이력(10%)
```

**방법 A: 추적 기반**
- 등번호 OCR로 초기 식별
- DeepSORT/ByteTrack으로 프레임 간 추적
- 카메라 전환 시 재식별

**방법 B: 공간 + 색상 기반**
- 유니폼 색상 클러스터링 (팀 구분)
- 필드 위치로 포지션 추정
- 선수 명단 매칭

**하이브리드 전략:**
- 등번호 보이면 OCR → 추적
- 안 보이면 색상 + 위치 + 이전 추적 이력 활용
- 불확실하면 팀 정보만 표시

### 3. 성능 최적화
**Lazy Tracking 전략:**
```
프레임 1: YOLO 전체 탐지 (무거움)
프레임 2-5: Optical Flow만 (10배 빠름)
프레임 6: YOLO 재실행 (재보정)
```

- 카메라 각도 변화 감지 시 즉시 YOLO 재실행
- 프레임 스킵 옵션 (10/20/30 FPS 선택)

## 🎮 타겟 플랫폼

### Phase 1: YouTube
- ✅ DRM 없음
- ✅ `<video>` 태그 직접 접근 가능
- ✅ Canvas 캡처 쉬움

### Phase 2: 쿠팡플레이
- ⚠️ DRM 있을 가능성 높음
- 📋 **해결책**: Chrome Screen Capture API
  - `desktopCapture` 권한 필요
  - 사용자 화면 공유 승인 (첫 실행 1회)

## 📊 예상 성능

### M4 맥북 기준
| 모델 | 정확도 | FPS | 선택 |
|------|--------|-----|------|
| YOLOv8-nano | 낮음 | 40-60 | ❌ |
| YOLOv8-small | 중간 | 25-35 | ✅ 최적 |
| YOLOv8-medium | 높음 | 15-20 | ⚠️ |

### 정확도 목표
- **공 탐지**: 90%+
- **선수 탐지**: 85%+
- **팀 구분**: 95%+
- **선수 이름**: 70%+ (합리적)

## 🚧 알려진 제약사항

### 기술적 제약
1. **저사양 PC 성능**: GPU 없으면 실시간 불가능
   - 해결: Electron 앱 필수 실행 안내
   - 최소 사양 명시 (Intel GPU 이상)

2. **선수 식별 한계**:
   - 등번호 항상 보이지 않음
   - 선수 교체 시 수동 입력 필요
   - 카메라 각도에 따라 정확도 변동

3. **DRM 플랫폼**:
   - Screen Capture API 사용 시 권한 요청
   - 일부 플랫폼 미지원 가능성

### 사용자 경험 트레이드오프
- **장점**: 실시간 선수 정보 제공, 중계 이해도 향상
- **단점**: Companion 앱 설치 필요, 화면 공유 권한 필요 (일부)

## 🎯 성공 기준

### MVP (Minimum Viable Product)
- [ ] YouTube 비디오에서 공 탐지
- [ ] 공 소유 선수에게 바운딩 박스 표시
- [ ] 팀 색상 구분 (홈/원정)
- [ ] 10+ FPS 성능

### V1.0 (정식 출시)
- [ ] 선수 이름 표시 (70%+ 정확도)
- [ ] 피파 스타일 UI
- [ ] YouTube + 쿠팡플레이 지원
- [ ] 경기 정보 입력 UI
- [ ] Chrome Web Store 배포

## 📈 향후 확장 가능성

- 실시간 통계 표시 (패스 성공률, 터치 수)
- 미니맵 오버레이 (선수 위치 추적)
- 하이라이트 자동 감지 (슈팅, 골)
- 다른 스포츠 지원 (농구, 야구)
- 멀티플레이어 분석 (전술 분석 모드)

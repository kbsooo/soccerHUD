# ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ìƒì„¸ ì„¤ê³„

## ğŸ›ï¸ ì „ì²´ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ì‚¬ìš©ì ë¸Œë¼ìš°ì €                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚           Chrome Extension                           â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚  Content Script (injected)                  â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  - Video element ê°ì§€                       â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  - Canvasë¡œ í”„ë ˆì„ ìº¡ì²˜ (30fps)            â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  - SVG ì˜¤ë²„ë ˆì´ ë Œë”ë§                      â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â”‚                 â”‚                                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚  Background Service Worker                   â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  - WebSocket ì—°ê²° ê´€ë¦¬                       â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  - ìƒíƒœ ê´€ë¦¬ (ì—°ê²°/ëŠê¹€)                    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  - Storage API (ì„¤ì • ì €ì¥)                  â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â”‚                 â”‚                                    â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚  Popup UI                                    â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  - í™œì„±í™” í† ê¸€                               â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  - ì„¤ì • (FPS, ë¯¼ê°ë„)                       â”‚    â”‚    â”‚
â”‚  â”‚  â”‚  - ê²½ê¸° ì •ë³´ ì…ë ¥                            â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ WebSocket (ws://localhost:8765)
                         â”‚ JSON messages
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Electron Companion App                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Main Process (Node.js)                              â”‚   â”‚
â”‚  â”‚  - Python ì„œë²„ í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬                         â”‚   â”‚
â”‚  â”‚  - ì‹œìŠ¤í…œ íŠ¸ë ˆì´ UI                                  â”‚   â”‚
â”‚  â”‚  - ìë™ ì—…ë°ì´íŠ¸                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                 â”‚                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Embedded Python Server (FastAPI)                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  WebSocket Handler                             â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - í”„ë ˆì„ ìˆ˜ì‹  (Base64/Binary)                 â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - ê²°ê³¼ ì „ì†¡ (JSON)                            â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚              â”‚                                        â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  Inference Pipeline                            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  1. Frame Preprocessing                        â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  2. YOLO Detection (CoreML/Metal)              â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  3. Post-processing                            â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  4. Ball Owner Calculation                     â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  5. Player Identification                      â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚              â”‚                                        â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚  Modules                                       â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - YOLO Model (CoreML)                         â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - Color Clustering (K-means)                  â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - OCR Engine (EasyOCR)                        â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - Tracker (DeepSORT/ByteTrack)                â”‚  â”‚   â”‚
â”‚  â”‚  â”‚  - Optical Flow (OpenCV)                       â”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ ì»´í¬ë„ŒíŠ¸ ìƒì„¸

### 1. Chrome Extension

#### 1.1 Content Script
**ì—­í• **: ì›¹í˜ì´ì§€ì— ì£¼ì…ë˜ì–´ ë¹„ë””ì˜¤ ìš”ì†Œì™€ ì§ì ‘ ìƒí˜¸ì‘ìš©

**ì£¼ìš” ê¸°ëŠ¥**:
```javascript
// ë¹„ë””ì˜¤ ê°ì§€
function detectVideo() {
  const video = document.querySelector('video');
  if (video) {
    setupVideoCapture(video);
  }
}

// í”„ë ˆì„ ìº¡ì²˜
function captureFrame(video) {
  const canvas = document.createElement('canvas');
  canvas.width = 640;  // ë‹¤ìš´ìŠ¤ì¼€ì¼
  canvas.height = 640;
  const ctx = canvas.getContext('2d');
  ctx.drawImage(video, 0, 0, 640, 640);
  return canvas.toDataURL('image/jpeg', 0.7);  // ì••ì¶•
}

// ì˜¤ë²„ë ˆì´ ë Œë”ë§
function renderOverlay(results) {
  const svg = createSVGOverlay(video);
  results.players.forEach(player => {
    drawBoundingBox(svg, player);
    if (player.name) {
      drawLabel(svg, player.name, player.number);
    }
  });
}
```

**ì´ë²¤íŠ¸ ì²˜ë¦¬**:
- `play`: ë¹„ë””ì˜¤ ì¬ìƒ ì‹œì‘ â†’ ìº¡ì²˜ ì‹œì‘
- `pause`: ë¹„ë””ì˜¤ ì¼ì‹œì •ì§€ â†’ ìº¡ì²˜ ì¤‘ì§€
- `seeked`: íƒìƒ‰ ì™„ë£Œ â†’ YOLO ì¬ì‹¤í–‰ (Optical Flow ë¦¬ì…‹)

#### 1.2 Background Service Worker
**ì—­í• **: WebSocket ì—°ê²° ê´€ë¦¬ ë° ìƒíƒœ ë™ê¸°í™”

**ì£¼ìš” ê¸°ëŠ¥**:
```javascript
// WebSocket ì—°ê²°
let ws = null;

function connectToServer() {
  ws = new WebSocket('ws://localhost:8765');

  ws.onopen = () => {
    chrome.storage.local.set({ serverStatus: 'connected' });
  };

  ws.onmessage = (event) => {
    const results = JSON.parse(event.data);
    // Content Scriptë¡œ ê²°ê³¼ ì „ë‹¬
    chrome.tabs.sendMessage(activeTabId, { type: 'YOLO_RESULTS', data: results });
  };

  ws.onerror = () => {
    chrome.storage.local.set({ serverStatus: 'error' });
    // ì¬ì—°ê²° ì‹œë„
    setTimeout(connectToServer, 3000);
  };
}
```

**ìƒíƒœ ê´€ë¦¬**:
- `serverStatus`: connected | disconnected | error
- `settings`: { fps: 30, sensitivity: 0.7, showNames: true }
- `matchInfo`: { homeTeam: [], awayTeam: [], formation: '4-4-2' }

#### 1.3 Popup UI
**ì—­í• **: ì‚¬ìš©ì ì„¤ì • ë° ê²½ê¸° ì •ë³´ ì…ë ¥

**í™”ë©´ êµ¬ì„±**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SoccerHUD             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [â—] í™œì„±í™”  (ë…¹ìƒ‰)    â”‚
â”‚                        â”‚
â”‚  ì„œë²„ ìƒíƒœ: ì—°ê²°ë¨ âœ“   â”‚
â”‚                        â”‚
â”‚  ì„¤ì •                  â”‚
â”‚  FPS: [â–“â–“â–“â–“â–‘â–‘] 30      â”‚
â”‚  ë¯¼ê°ë„: [â–“â–“â–“â–‘â–‘â–‘] 0.7  â”‚
â”‚  [âœ“] ì„ ìˆ˜ ì´ë¦„ í‘œì‹œ     â”‚
â”‚                        â”‚
â”‚  ê²½ê¸° ì •ë³´             â”‚
â”‚  [ê²½ê¸° ì •ë³´ ì…ë ¥ â–¶]    â”‚
â”‚                        â”‚
â”‚  ë„ì›€ë§ | GitHub       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 2. Python Backend (FastAPI)

#### 2.1 ì„œë²„ êµ¬ì¡°

```python
# main.py
from fastapi import FastAPI, WebSocket
from inference import InferencePipeline
import asyncio

app = FastAPI()
pipeline = InferencePipeline(model_path="yolov8s.mlmodel")

@app.websocket("/ws")
async def websocket_endpoint(websocket: WebSocket):
    await websocket.accept()

    try:
        while True:
            # í”„ë ˆì„ ìˆ˜ì‹ 
            frame_data = await websocket.receive_bytes()

            # ì¶”ë¡ 
            results = await pipeline.process(frame_data)

            # ê²°ê³¼ ì „ì†¡
            await websocket.send_json(results)

    except Exception as e:
        print(f"Error: {e}")
    finally:
        await websocket.close()
```

#### 2.2 Inference Pipeline

```python
# inference.py
import cv2
import numpy as np
from ultralytics import YOLO

class InferencePipeline:
    def __init__(self, model_path):
        self.model = YOLO(model_path)
        self.tracker = DeepSORT()
        self.color_clusterer = ColorClusterer()

    async def process(self, frame_bytes):
        # 1. ë””ì½”ë”©
        frame = self.decode_frame(frame_bytes)

        # 2. YOLO ì¶”ë¡  (Lazy Tracking ì ìš©)
        if self.should_run_yolo():
            detections = self.model(frame)
            self.last_yolo_frame = frame
        else:
            detections = self.optical_flow_track(frame)

        # 3. ê³µ ì†Œìœ ì ê³„ì‚°
        ball_owner = self.calculate_ball_owner(detections)

        # 4. ì„ ìˆ˜ ì‹ë³„
        players = self.identify_players(detections)

        # 5. JSON ìƒì„±
        return {
            "timestamp": time.time(),
            "ball": self.format_ball(detections.ball),
            "players": self.format_players(players),
            "ball_owner": ball_owner
        }

    def should_run_yolo(self):
        # Lazy Tracking: 5 í”„ë ˆì„ë§ˆë‹¤ YOLO ì‹¤í–‰
        if self.frame_count % 5 == 0:
            return True
        # ì¹´ë©”ë¼ ì „í™˜ ê°ì§€
        if self.detect_scene_change():
            return True
        return False
```

#### 2.3 ì„ ìˆ˜ ì‹ë³„ ëª¨ë“ˆ

```python
# player_identification.py

class PlayerIdentifier:
    def __init__(self):
        self.ocr = easyocr.Reader(['en'])
        self.tracker = DeepSORT()
        self.color_clusterer = KMeans(n_clusters=2)  # 2íŒ€

    def identify(self, player_bbox, frame, match_info):
        score = 0
        candidate = {}

        # 1. ìœ ë‹ˆí¼ ìƒ‰ìƒ (40%)
        color = self.extract_uniform_color(player_bbox, frame)
        team = self.match_color_to_team(color)
        candidate['team'] = team
        score += 0.4

        # 2. ë“±ë²ˆí˜¸ OCR (30%)
        number_region = self.detect_number_region(player_bbox, frame)
        if number_region:
            number = self.ocr_number(number_region)
            if number:
                candidate['number'] = number
                candidate['name'] = match_info.get_player_by_number(team, number)
                score += 0.3

        # 3. í•„ë“œ ìœ„ì¹˜ (20%)
        position = self.estimate_position(player_bbox, frame)
        if position:
            candidate['position'] = position
            score += 0.2

        # 4. ì¶”ì  ì´ë ¥ (10%)
        tracked_id = self.tracker.update(player_bbox)
        if tracked_id in self.player_history:
            candidate.update(self.player_history[tracked_id])
            score += 0.1

        candidate['confidence'] = score
        return candidate
```

---

## ğŸ”„ ë°ì´í„° í”Œë¡œìš°

### ì •ìƒ í”Œë¡œìš°
```
1. [Browser] ë¹„ë””ì˜¤ ì¬ìƒ ì¤‘
2. [Content Script] Canvasë¡œ í”„ë ˆì„ ìº¡ì²˜ (30fps)
3. [Content Script] 640x640 ë¦¬ì‚¬ì´ì¦ˆ + JPEG ì••ì¶•
4. [Background Worker] WebSocketìœ¼ë¡œ ì „ì†¡ (~50KB)
5. [Python Server] í”„ë ˆì„ ìˆ˜ì‹  (<5ms)
6. [Inference] YOLO ì¶”ë¡  (30-40ms)
7. [Inference] í›„ì²˜ë¦¬ (ê³µ ì†Œìœ , ì„ ìˆ˜ ì‹ë³„) (10ms)
8. [Python Server] JSON ê²°ê³¼ ì „ì†¡
9. [Background Worker] Content Scriptë¡œ ì „ë‹¬
10. [Content Script] SVG ì˜¤ë²„ë ˆì´ ë Œë”ë§ (5ms)

ì´ ë ˆì´í„´ì‹œ: ~50-60ms (ì‹¤ì‹œê°„ ê°€ëŠ¥)
```

### ì—ëŸ¬ í”Œë¡œìš°
```
1. [Background Worker] WebSocket ì—°ê²° ì‹¤íŒ¨
   â†’ 3ì´ˆ í›„ ì¬ì—°ê²° ì‹œë„
   â†’ 5íšŒ ì‹¤íŒ¨ ì‹œ ì‚¬ìš©ì ì•Œë¦¼ ("Companion ì•± ì‹¤í–‰ í•„ìš”")

2. [Python Server] YOLO ì¶”ë¡  ì‹¤íŒ¨
   â†’ ì´ì „ ê²°ê³¼ ì¬ì‚¬ìš©
   â†’ ë¡œê·¸ ê¸°ë¡ í›„ ê³„ì† ì§„í–‰

3. [Content Script] ë¹„ë””ì˜¤ ìš”ì†Œ ì—†ìŒ
   â†’ 1ì´ˆë§ˆë‹¤ ì¬íƒìƒ‰
   â†’ 10ì´ˆ í›„ í¬ê¸° ë° ì•Œë¦¼
```

---

## ğŸ—„ï¸ ë°ì´í„° ëª¨ë¸

### WebSocket ë©”ì‹œì§€ í¬ë§·

#### Request (Browser â†’ Server)
```json
{
  "type": "frame",
  "timestamp": 1234567890.123,
  "data": "base64_encoded_jpeg_image...",
  "metadata": {
    "videoWidth": 1920,
    "videoHeight": 1080,
    "currentTime": 123.45
  }
}
```

#### Response (Server â†’ Browser)
```json
{
  "type": "detection",
  "timestamp": 1234567890.124,
  "fps": 28.5,
  "ball": {
    "x": 320,
    "y": 240,
    "width": 20,
    "height": 20,
    "confidence": 0.95
  },
  "players": [
    {
      "id": 1,
      "x": 300,
      "y": 250,
      "width": 60,
      "height": 120,
      "team": "home",
      "color": [255, 0, 0],
      "number": 7,
      "name": "ì†í¥ë¯¼",
      "position": "FW",
      "confidence": 0.88
    }
  ],
  "ball_owner": {
    "player_id": 1,
    "distance": 15.3,
    "confidence": 0.92
  }
}
```

---

## âš™ï¸ ì„¤ì • ë° ìµœì í™”

### ì„±ëŠ¥ íŠœë‹ íŒŒë¼ë¯¸í„°

```python
# config.py
class Config:
    # ëª¨ë¸ ì„¤ì •
    MODEL_SIZE = "small"  # nano | small | medium
    INPUT_SIZE = 640      # ì…ë ¥ í•´ìƒë„
    CONFIDENCE_THRESHOLD = 0.5
    IOU_THRESHOLD = 0.4

    # Lazy Tracking
    YOLO_INTERVAL = 5     # 5 í”„ë ˆì„ë§ˆë‹¤ YOLO ì‹¤í–‰
    SCENE_CHANGE_THRESHOLD = 0.3  # ì¥ë©´ ì „í™˜ ê°ì§€ ì„ê³„ê°’

    # í”„ë ˆì„ ì²˜ë¦¬
    TARGET_FPS = 30
    JPEG_QUALITY = 70

    # ì„ ìˆ˜ ì‹ë³„
    OCR_CONFIDENCE_THRESHOLD = 0.6
    COLOR_MATCHING_THRESHOLD = 30  # RGB ìœ í´ë¦¬ë“œ ê±°ë¦¬
    BALL_OWNER_MAX_DISTANCE = 50   # í”½ì…€
```

### ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ì˜ˆìƒ

| í•­ëª© | ì‚¬ìš©ëŸ‰ |
|------|--------|
| **CPU** | 30-50% (1 ì½”ì–´) |
| **GPU** | Metal í™œìš© ì‹œ íš¨ìœ¨ì  |
| **ë©”ëª¨ë¦¬** | ~500MB (ëª¨ë¸ ë¡œë”© í¬í•¨) |
| **ë„¤íŠ¸ì›Œí¬** | 1.5 MB/s (30fps Ã— 50KB) |
| **ë””ìŠ¤í¬** | ~200MB (ëª¨ë¸ + ì•±) |

---

## ğŸ” ë³´ì•ˆ ë° í”„ë¼ì´ë²„ì‹œ

### ë°ì´í„° ì²˜ë¦¬ ì •ì±…
- âœ… **ë¹„ë””ì˜¤ í”„ë ˆì„**: ë¡œì»¬ì—ì„œë§Œ ì²˜ë¦¬, ì™¸ë¶€ ì „ì†¡ ì—†ìŒ
- âœ… **ê°œì¸ì •ë³´**: ìˆ˜ì§‘í•˜ì§€ ì•ŠìŒ
- âœ… **ê²½ê¸° ì •ë³´**: ë¸Œë¼ìš°ì € ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ë§Œ ì €ì¥
- âœ… **ë„¤íŠ¸ì›Œí¬**: localhostë§Œ ì‚¬ìš© (ì™¸ë¶€ í†µì‹  ì—†ìŒ)

### Chrome ìŠ¤í† ì–´ ì •ì±… ì¤€ìˆ˜
- Content Security Policy (CSP) ì¤€ìˆ˜
- `host_permissions` ìµœì†Œí™” (í•„ìš”í•œ ì‚¬ì´íŠ¸ë§Œ)
- `externally_connectable` ì œí•œ
- ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨ ëª…ì‹œ

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì „ëµ

### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- YOLO ì¶”ë¡  ì •í™•ë„
- ê³µ ì†Œìœ ì ê³„ì‚° ë¡œì§
- ìƒ‰ìƒ í´ëŸ¬ìŠ¤í„°ë§
- OCR ì •í™•ë„

### í†µí•© í…ŒìŠ¤íŠ¸
- WebSocket í†µì‹ 
- í”„ë ˆì„ ìº¡ì²˜ â†’ ì¶”ë¡  â†’ ë Œë”ë§ E2E
- ì—ëŸ¬ í•¸ë“¤ë§ (ì„œë²„ ëŠê¹€, ì¬ì—°ê²°)

### ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
- FPS ë²¤ì¹˜ë§ˆí¬ (ë‹¤ì–‘í•œ í•´ìƒë„)
- ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ì²´í¬ (ì¥ì‹œê°„ ì‹¤í–‰)
- GPU í™œìš©ë¥  ëª¨ë‹ˆí„°ë§

### ì‚¬ìš©ì í…ŒìŠ¤íŠ¸
- ë‹¤ì–‘í•œ ê²½ê¸° ì˜ìƒ (ì¡°ëª…, ê°ë„)
- YouTube, ì¿ íŒ¡í”Œë ˆì´ í˜¸í™˜ì„±
- ë‹¤ì–‘í•œ PC ì‚¬ì–‘ì—ì„œ í…ŒìŠ¤íŠ¸
